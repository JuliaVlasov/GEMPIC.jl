<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Strong Landau Damping · GEMPIC</title><meta name="title" content="Strong Landau Damping · GEMPIC"/><meta property="og:title" content="Strong Landau Damping · GEMPIC"/><meta property="twitter:title" content="Strong Landau Damping · GEMPIC"/><meta name="description" content="Documentation for GEMPIC."/><meta property="og:description" content="Documentation for GEMPIC."/><meta property="twitter:description" content="Documentation for GEMPIC."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GEMPIC</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../">GEMPIC.jl Documentation</a></li><li><a class="tocitem" href="../mesh/">Mesh</a></li><li><a class="tocitem" href="../low_level_bsplines/">Splines</a></li><li><a class="tocitem" href="../splinepp/">Periodic spline</a></li><li><a class="tocitem" href="../particle_mesh_coupling/">Particle-Mesh coupling</a></li><li><a class="tocitem" href="../distributions/">Distributions</a></li><li><a class="tocitem" href="../particle_group/">Particle group</a></li><li><a class="tocitem" href="../particle_sampling/">Particle sampling</a></li><li><a class="tocitem" href="../maxwell_solver/">Maxwell solver</a></li><li><input class="collapse-toggle" id="menuitem-1-10" type="checkbox"/><label class="tocitem" for="menuitem-1-10"><span class="docs-label">Splitting</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../hamiltonian_splitting/">Hamiltonian splitting</a></li><li><a class="tocitem" href="../hamiltonian_splitting_boris/">Hamiltonian splitting Boris</a></li></ul></li><li><a class="tocitem" href="../diagnostics/">Diagnostics</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Strong Landau Damping</a><ul class="internal"><li><a class="tocitem" href="#Initialize-field-solver"><span>Initialize field solver</span></a></li><li><a class="tocitem" href="#Simulation-function"><span>Simulation function</span></a></li><li><a class="tocitem" href="#Time-evolution-of-electric-energy"><span>Time evolution of electric energy</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../contents/">Contents</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Strong Landau Damping</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Strong Landau Damping</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaVlasov/GEMPIC.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaVlasov/GEMPIC.jl/blob/master/docs/src/strong_landau_damping.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Strong-Landau-Damping"><a class="docs-heading-anchor" href="#Strong-Landau-Damping">Strong Landau Damping</a><a id="Strong-Landau-Damping-1"></a><a class="docs-heading-anchor-permalink" href="#Strong-Landau-Damping" title="Permalink"></a></h1><p>If we only use the subsystems <span>$H_p$</span> and <span>$H_E$</span>, we are solving Vlasov–Poisson system. In this test, initial condition is as follows:</p><p class="math-container">\[f_0(x,v) = \frac{1}{\sqrt{2\pi} \sigma}e^{-\frac{v^2}{2\sigma^2}}(1+\alpha \cos(kx)), \quad E_{10} (x) = \frac{\alpha}{k}\sin(kx), \ x \in [0,2\pi/k ),  \ v \in \mathbb{R}^2.\]</p><pre><code class="language-julia hljs">using GEMPIC</code></pre><p>The physical parameters are chosen as <span>$\sigma = 1$</span>, <span>$k = 0.5$</span>, <span>$\alpha = 0.5$</span>, and the numerical parameters as <span>$\Delta t = 0.05$</span>, <span>$n_x = 32$</span> and <span>$2 \times 10^5$</span> particles. We use second order Strang splitting method in time.</p><pre><code class="language-julia hljs">σ, μ = 1.0, 0.0
kx, α = 0.5, 0.5
xmin, xmax = 0, 2π/kx
∆t = 0.05
nx = 32
n_particles = 100000
mesh = OneDGrid( xmin, xmax, nx)
spline_degree = 3

df = CosSumGaussian{1,2}([[kx]], [α], [[σ,σ]], [[μ,μ]] )

mass, charge = 1.0, 1.0
particle_group = ParticleGroup{1,2}(n_particles)
sampler = ParticleSampler{1,2}( :sobol, true, n_particles)

sample!(particle_group, sampler, df, mesh)

xp = view(particle_group.array, 1, :)
vp = view(particle_group.array, 2:3, :)
wp = view(particle_group.array, 4, :);

p = plot(layout=(3,1))
histogram!(p[1,1], xp, weights=wp, normalize=true, bins = 100, lab = &quot;&quot;)
plot!(p[1,1], x-&gt; (1+α*cos(kx*x))/(2π/kx), 0., 2π/kx, lab=&quot;&quot;)
histogram!(p[2,1], vp[1,:], weights=wp, normalize=true, bins = 100, lab = &quot;&quot;)
plot!(p[2,1], v-&gt; exp( - v^2 / 2) * 4 / π^2 , -6, 6, lab=&quot;&quot;)
histogram!(p[3,1], vp[2,:], weights=wp, normalize=true, bins = 100, lab = &quot;&quot;)
plot!(p[3,1], v-&gt; exp( - v^2 / 2) * 4 / π^2 , -6, 6, lab=&quot;&quot;)</code></pre><img src="4b2fc3f6.svg" alt="Example block output"/><p>Initialize the arrays for the spline coefficients of the fields</p><pre><code class="language-julia hljs">kernel_smoother1 = ParticleMeshCoupling1D( mesh, n_particles, spline_degree-1, :galerkin)
kernel_smoother0 = ParticleMeshCoupling1D( mesh, n_particles, spline_degree, :galerkin)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ParticleMeshCoupling1D(1, 0.39269908169872414, 32, 32, 100000, 3, 4, 1.0, 2, [0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0], [-0.5773502691896258, 0.5773502691896258], [1.0, 1.0], GEMPIC.SplinePP{4}(3, [-0.16666666666666666 0.5 -0.5 0.16666666666666666; 0.5 -1.0 0.5 0.0; -0.5 0.0 0.5 0.0; 0.16666666666666666 0.6666666666666666 0.16666666666666666 0.0], [-0.041666666666666664 0.125 -0.125 0.041666666666666664; 0.16666666666666666 -0.3333333333333333 0.16666666666666666 0.0; -0.25 0.0 0.25 0.0; 0.16666666666666666 0.6666666666666666 0.16666666666666666 0.0], 32), 0.0, 12.566370614359172)</code></pre><h2 id="Initialize-field-solver"><a class="docs-heading-anchor" href="#Initialize-field-solver">Initialize field solver</a><a id="Initialize-field-solver-1"></a><a class="docs-heading-anchor-permalink" href="#Initialize-field-solver" title="Permalink"></a></h2><pre><code class="language-julia hljs">p = plot(layout=(1,2))
rho = zeros(Float64, nx)
efield_poisson = zeros(Float64, nx)
maxwell_solver = Maxwell1DFEM(mesh, spline_degree)
solve_poisson!( efield_poisson, particle_group, kernel_smoother0, maxwell_solver, rho )
xg = LinRange(xmin, xmax, nx)
sval = eval_uniform_periodic_spline_curve(spline_degree-1, rho)
plot!(p[1,1], xg, sval, title=:rho, label=nothing)
sval = eval_uniform_periodic_spline_curve(spline_degree-1, efield_poisson)
plot!(p[1,2], xg, sval, title=:ex, label=nothing )</code></pre><img src="78ca5a7f.svg" alt="Example block output"/><h2 id="Simulation-function"><a class="docs-heading-anchor" href="#Simulation-function">Simulation function</a><a id="Simulation-function-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-function" title="Permalink"></a></h2><p>You will get better performance if your simulation is inside a function:</p><pre><code class="language-julia hljs">function run( steps)

    σ, μ = 1.0, 0.0
    kx, α = 0.5, 0.5
    xmin, xmax = 0, 2π/kx
    dt = 0.05
    nx = 32
    n_particles = 100000
    mesh = OneDGrid( xmin, xmax, nx)
    spline_degree = 3

    df = CosSumGaussian{1,2}([[kx]], [α], [[σ,σ]], [[μ,μ]] )

    mass, charge = 1.0, 1.0
    particle_group = ParticleGroup{1,2}(n_particles)
    sampler = ParticleSampler{1,2}( :sobol, true, n_particles)

    sample!(particle_group, sampler, df, mesh)

    kernel_smoother1 = ParticleMeshCoupling1D( mesh, n_particles, spline_degree-1, :galerkin)
    kernel_smoother0 = ParticleMeshCoupling1D( mesh, n_particles, spline_degree, :galerkin)

    rho = zeros(Float64, nx)
    efield_poisson = zeros(Float64, nx)

    maxwell_solver = Maxwell1DFEM(mesh, spline_degree)

    solve_poisson!( efield_poisson, particle_group, kernel_smoother0, maxwell_solver, rho )

    efield_dofs = [efield_poisson, zeros(Float64, nx)]
    bfield_dofs = zeros(Float64, nx)

    propagator = HamiltonianSplitting{1,2}( maxwell_solver,
                                       kernel_smoother0,
                                       kernel_smoother1,
                                       particle_group,
                                       efield_dofs,
                                       bfield_dofs)

    efield_dofs_n = propagator.e_dofs

    thdiag = TimeHistoryDiagnostics( particle_group, maxwell_solver,
                            kernel_smoother0, kernel_smoother1 )

    for j = 1:steps # loop over time

        strang_splitting!(propagator, dt, 1)

        solve_poisson!( efield_poisson, particle_group,
                        kernel_smoother0, maxwell_solver, rho)

        write_step!(thdiag, j * dt, spline_degree,
                        efield_dofs,  bfield_dofs,
                        efield_dofs_n, efield_poisson)
    end

    return thdiag.data

end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">run (generic function with 1 method)</code></pre><pre><code class="language-julia hljs">@time results = run(1000);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> 55.133443 seconds (537.50 k allocations: 41.756 MiB, 0.06% gc time, 0.93% compilation time)</code></pre><h2 id="Time-evolution-of-electric-energy"><a class="docs-heading-anchor" href="#Time-evolution-of-electric-energy">Time evolution of electric energy</a><a id="Time-evolution-of-electric-energy-1"></a><a class="docs-heading-anchor-permalink" href="#Time-evolution-of-electric-energy" title="Permalink"></a></h2><pre><code class="language-julia hljs">plot(results[!,:Time], log.(results[!,:PotentialEnergyE1]))</code></pre><img src="5633b04d.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../diagnostics/">« Diagnostics</a><a class="docs-footer-nextpage" href="../contents/">Contents »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Wednesday 15 May 2024 16:10">Wednesday 15 May 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
